<map version="freeplane 1.8.0">
<!--To view this file, download free mind mapping software Freeplane from http://freeplane.sourceforge.net -->
<node TEXT="tomcat" FOLDED="false" ID="ID_1082306802" CREATED="1608096377603" MODIFIED="1608096390376" STYLE="oval">
<font SIZE="18"/>
<hook NAME="MapStyle">
    <properties fit_to_viewport="false" edgeColorConfiguration="#808080ff,#ff0000ff,#0000ffff,#00ff00ff,#ff00ffff,#00ffffff,#7c0000ff,#00007cff,#007c00ff,#7c007cff,#007c7cff,#7c7c00ff"/>

<map_styles>
<stylenode LOCALIZED_TEXT="styles.root_node" STYLE="oval" UNIFORM_SHAPE="true" VGAP_QUANTITY="24.0 pt">
<font SIZE="24"/>
<stylenode LOCALIZED_TEXT="styles.predefined" POSITION="right" STYLE="bubble">
<stylenode LOCALIZED_TEXT="default" ICON_SIZE="12.0 pt" COLOR="#000000" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt" NUMBERED="true" BORDER_WIDTH="2.0 px">
<font NAME="微软雅黑" SIZE="12" BOLD="false" ITALIC="false"/>
<edge STYLE="horizontal"/>
</stylenode>
<stylenode LOCALIZED_TEXT="defaultstyle.details" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt"/>
<stylenode LOCALIZED_TEXT="defaultstyle.attributes" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt">
<font SIZE="9"/>
</stylenode>
<stylenode LOCALIZED_TEXT="defaultstyle.note" COLOR="#000000" BACKGROUND_COLOR="#ffffff" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt" TEXT_ALIGN="LEFT"/>
<stylenode LOCALIZED_TEXT="defaultstyle.floating">
<edge STYLE="hide_edge"/>
<cloud COLOR="#f0f0f0" SHAPE="ROUND_RECT"/>
</stylenode>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.user-defined" POSITION="right" STYLE="bubble">
<stylenode LOCALIZED_TEXT="styles.topic" COLOR="#18898b" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt">
<font NAME="Liberation Sans" SIZE="10" BOLD="true"/>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.subtopic" COLOR="#cc3300" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt">
<font NAME="Liberation Sans" SIZE="10" BOLD="true"/>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.subsubtopic" COLOR="#669900" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt">
<font NAME="Liberation Sans" SIZE="10" BOLD="true"/>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.important" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt">
<icon BUILTIN="yes"/>
</stylenode>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.AutomaticLayout" POSITION="right" STYLE="bubble">
<stylenode LOCALIZED_TEXT="AutomaticLayout.level.root" COLOR="#000000" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt">
<font SIZE="18"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,1" COLOR="#0033ff" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt">
<font SIZE="16"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,2" COLOR="#00b439" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt">
<font SIZE="14"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,3" COLOR="#990000" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt">
<font SIZE="12"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,4" COLOR="#111111" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt">
<font SIZE="10"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,5" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,6" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,7" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,8" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,9" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,10" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,11" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt"/>
</stylenode>
</stylenode>
</map_styles>
</hook>
<hook NAME="AutomaticEdgeColor" COUNTER="27" RULE="ON_BRANCH_CREATION"/>
<node TEXT="概述" POSITION="right" ID="ID_81861432" CREATED="1608097196385" MODIFIED="1608097209574">
<edge COLOR="#00ff00"/>
<node TEXT="依赖java" ID="ID_479733419" CREATED="1608096391346" MODIFIED="1608097196415">
<node TEXT="java-1.8.0-openjdk" ID="ID_341201377" CREATED="1608096433339" MODIFIED="1608096454156"/>
</node>
<node TEXT="网页程序使用java语言编写" ID="ID_951828034" CREATED="1608097210897" MODIFIED="1608097223299"/>
<node TEXT="端口" ID="ID_1551492878" CREATED="1608097243655" MODIFIED="1608097246811">
<node TEXT="8005  开发端口" ID="ID_1761074187" CREATED="1608097246819" MODIFIED="1608097253996"/>
<node TEXT="8009" OBJECT="java.lang.Long|8009" ID="ID_1992462747" CREATED="1608097263195" MODIFIED="1608097266205"/>
<node TEXT="8080  服务端口" ID="ID_298150833" CREATED="1608097266576" MODIFIED="1608097272275"/>
<node TEXT="8443  https服务端口" ID="ID_1706845781" CREATED="1608097283174" MODIFIED="1608097293505"/>
</node>
</node>
<node TEXT="部署" POSITION="right" ID="ID_1056614134" CREATED="1608096468576" MODIFIED="1608096486267">
<edge COLOR="#0000ff"/>
<node TEXT="安装" ID="ID_1107499311" CREATED="1608096816364" MODIFIED="1608096820924">
<node TEXT="解压到/usr/local/下修改目录名为tomcat" ID="ID_1277115347" CREATED="1608096486274" MODIFIED="1608096527996"/>
<node TEXT="bin/  存方主要程序" ID="ID_902604346" CREATED="1608096549676" MODIFIED="1608096563706"/>
<node TEXT="logs/  存放日志文件" ID="ID_1229269268" CREATED="1608096563965" MODIFIED="1608096576956"/>
<node TEXT="conf/  存放配置文件" ID="ID_612131000" CREATED="1608096577176" MODIFIED="1608096586356"/>
<node TEXT="webapps/  网站页面目录webapps/ROOT为默认页存放目录" ID="ID_630530798" CREATED="1608096586786" MODIFIED="1608096624936"/>
<node TEXT="work/  自动编译的目录" ID="ID_217441750" CREATED="1608096626408" MODIFIED="1608096641326"/>
<node TEXT="temp/  临时文件目录" ID="ID_953494840" CREATED="1608096642104" MODIFIED="1608096655859"/>
<node TEXT="lib/  库文件目录" ID="ID_99472342" CREATED="1608096656335" MODIFIED="1608096665756"/>
</node>
<node TEXT="启动服务" ID="ID_587557104" CREATED="1608096826678" MODIFIED="1608096830315">
<node TEXT="tomcat运行时需要/dev/random中的大量数据但random产生数据速度太慢需改用urandom&#xa;mv /dev/random /dev/random.bak  更改random文件名做为备份&#xa;ln -s /dev/urandom /dev/random  用urandom软链接替换random&#xa;另一种解决方案&#xa;安装rng-tools&#xa;systemctl start rngd  启动rng服务&#xa;systemctl enable rngd  设置为自启动" ID="ID_1758450472" CREATED="1608096833355" MODIFIED="1608097151355"/>
<node TEXT="bin/startup.sh  启动服务" ID="ID_21017925" CREATED="1608096745824" MODIFIED="1608096766395"/>
<node TEXT="bin/shutdown.sh  关闭服务" ID="ID_314818925" CREATED="1608096766605" MODIFIED="1608096782425"/>
</node>
<node TEXT="虚拟主机" ID="ID_1017854989" CREATED="1608097315568" MODIFIED="1608097320178">
<node TEXT="conf/server.xml&#xa;...&#xa;&lt;Host name=&quot;www.a.com&quot; appBase=&quot;a&quot; unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot;&gt;&#xa;&lt;/Host&gt;&#xa;&lt;Host name=&quot;www.b.com&quot; appBase=&quot;b&quot; unpackWARs=&quot;true&quot; autoDeploy=&quot;true&quot;&gt;&#xa;&lt;/Host&gt;&#xa;name主机域名appBase网页根目录填写相对路径,并且默认在该目录下的ROOT下,unpackWARs是否启用自动解war包功能,autoDeploy是否开启自动更新网站功能" ID="ID_284342283" CREATED="1608097320188" MODIFIED="1608097816644"/>
<node TEXT="创建对应目录" ID="ID_618665156" CREATED="1608097857624" MODIFIED="1608097867028">
<node TEXT="mkdir -p /usr/local/tomcat/{a,b}/ROOT" ID="ID_1875625823" CREATED="1608097867048" MODIFIED="1608097893749"/>
</node>
<node TEXT="修改主机默认页路径" ID="ID_261371078" CREATED="1608097955200" MODIFIED="1608097977320">
<node TEXT="conf/server.xml&#xa;...&#xa;&lt;Host name=&quot;www.b.com&quot; appBase=&quot;b&quot; unpackWARS=&quot;true&quot; autoDeploy=&quot;true&quot;&gt;&#xa;&lt;Context path=&quot;&quot; docBase=&quot;base&quot;/&gt;&#xa;&lt;/Host&gt;&#xa;context path客户端输入域名后跟的路径后缀,跳转到docBase指定网页目录下的文件,当docBase为空时访问appBase目录下的网页当docBase为相对路径时表示该目录在appBase指定的目录下的子目录" ID="ID_1171478995" CREATED="1608097977334" MODIFIED="1608098767846"/>
</node>
<node TEXT="为主机添加日志" ID="ID_1219727258" CREATED="1608099932686" MODIFIED="1608099956743">
<node TEXT="conf/server.xml&#xa;...&#xa;&lt;Host name=&quot;www.a.com&quot; appBase=&quot;a&quot; unpackWARS=&quot;true&quot; autoDeploy=&quot;true&quot;&gt;&#xa;&lt;Context path=&quot;/test&quot; docBase=&quot;/var/www/html/&quot; /&gt;&#xa;#从默认localhost虚拟主机中把Valve这段复制过来，适当修改下即可&#xa;&lt;Valve className=&quot;org.apache.catalina.valves.AccessLogValve&quot; directory=&quot;logs&quot;&#xa;               prefix=&quot;a_access&quot; suffix=&quot;.txt&quot;&#xa;               pattern=&quot;%h %l %u %t &amp;quot;%r&amp;quot; %s %b&quot; /&gt;&#xa;&lt;/Host&gt;&#xa;&lt;Host name=&quot;www.b.com&quot; appBase=&quot;b&quot; unpackWARS=&quot;true&quot; autoDeploy=&quot;true&quot;&gt;&#xa;&lt;Context path=&quot;&quot; docBase=&quot;base&quot; /&gt;&#xa;&lt;Valve className=&quot;org.apache.catalina.valves.AccessLogValve&quot; directory=&quot;logs&quot;&#xa;               prefix=&quot;b_access&quot; suffix=&quot;.txt&quot;&#xa;               pattern=&quot;%h %l %u %t &amp;quot;%r&amp;quot; %s %b&quot; /&gt;&#xa;&lt;/Host&gt;" ID="ID_583703241" CREATED="1608099956759" MODIFIED="1608101122117"/>
</node>
<node TEXT="ssl加密" ID="ID_1554693847" CREATED="1608101132932" MODIFIED="1608101143819">
<node TEXT="创建私钥和证书" ID="ID_203116820" CREATED="1608101143843" MODIFIED="1608101781537">
<node TEXT="keytool -genkeypair -alias tomcat -keyalg RSA -keystore /usr/local/tomcat/keystore  //genkeypair生成密钥对,alias设置密钥别名,keyalg RSA定义加密算法为RSA,keystore指定存储路径与文件名" ID="ID_567795848" CREATED="1608101170739" MODIFIED="1608101316202"/>
</node>
<node TEXT="创建支持加密连接的connector" ID="ID_1607707089" CREATED="1608101320186" MODIFIED="1608101813057">
<node TEXT="conf/server.xml&#xa;&lt;Connector port=&quot;8443&quot; protocol=&quot;org.apache.coyote.http11.Http11NioProtocol&quot;&#xa;maxThreads=&quot;150&quot; SSLEnabled=&quot;true&quot; scheme=&quot;https&quot; secure=&quot;true&quot;&#xa;keystoreFile=&quot;/usr/local/tomcat/keystore&quot; keystorePass=&quot;123456&quot; clientAuth=&quot;false&quot; sslProtocol=&quot;TLS&quot; /&gt;&#xa;//备注，默认这段Connector被注释掉了，打开注释，添加密钥信息即可" ID="ID_299390964" CREATED="1608101813072" MODIFIED="1608101843747"/>
</node>
</node>
</node>
<node TEXT="集群" ID="ID_1780651700" CREATED="1608101871981" MODIFIED="1608101876063">
<node TEXT="代理主机配置nginx集群" ID="ID_537249013" CREATED="1608101876083" MODIFIED="1608101949657">
<node TEXT="conf/nginx.conf&#xa;http{&#xa;    upstream toms {&#xa;        server 192.168.2.100:8080;&#xa;        server 192.168.2.200:8080;&#xa;    }&#xa;    server  {&#xa;        listen 80;&#xa;        server_name localhost;&#xa;        location / {&#xa;            proxy_pass  http://toms;&#xa;        }&#xa;    }&#xa;}" ID="ID_1156382168" CREATED="1608101908391" MODIFIED="1608101942282"/>
</node>
<node TEXT="web主机配置tomcat调度器" ID="ID_427689870" CREATED="1608101966590" MODIFIED="1608101981687">
<node TEXT="安装安装java-1.8.0-openjdk-headless" ID="ID_693976738" CREATED="1608102014910" MODIFIED="1608102030026"/>
<node TEXT="启动tomcat" ID="ID_1542532050" CREATED="1608102055589" MODIFIED="1608102062626"/>
</node>
</node>
</node>
<node TEXT="查询" POSITION="right" ID="ID_239308072" CREATED="1608102102556" MODIFIED="1608102106740">
<edge COLOR="#00ffff"/>
<node TEXT="ss -nutlp | grep java" ID="ID_1048213324" CREATED="1608102106765" MODIFIED="1608102125784"/>
<node TEXT="curl -k https://192.168.4.5  访问ssl加密连接" ID="ID_1389141150" CREATED="1608102129486" MODIFIED="1608102168451"/>
</node>
</node>
</map>
