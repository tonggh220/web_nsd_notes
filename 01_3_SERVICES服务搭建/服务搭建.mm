<map version="freeplane 1.8.0">
<!--To view this file, download free mind mapping software Freeplane from http://freeplane.sourceforge.net -->
<node TEXT="服务搭建与管理" FOLDED="false" ID="ID_1199348179" CREATED="1605329589907" MODIFIED="1606279468182" STYLE="wide_hexagon" UNIFORM_SHAPE="true">
<font SIZE="24" BOLD="true"/>
<hook NAME="MapStyle" zoom="0.799">
    <properties fit_to_viewport="false" edgeColorConfiguration="#808080ff,#ff0000ff,#0000ffff,#00ff00ff,#ff00ffff,#00ffffff,#7c0000ff,#00007cff,#007c00ff,#7c007cff,#007c7cff,#7c7c00ff"/>

<map_styles>
<stylenode LOCALIZED_TEXT="styles.root_node" STYLE="oval" UNIFORM_SHAPE="true" VGAP_QUANTITY="24.0 pt">
<font SIZE="24"/>
<stylenode LOCALIZED_TEXT="styles.predefined" POSITION="right" STYLE="bubble">
<stylenode LOCALIZED_TEXT="default" ICON_SIZE="12.0 pt" COLOR="#000000" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt" NUMBERED="true" BORDER_WIDTH="2.0 px">
<font NAME="微软雅黑" SIZE="12" BOLD="false" ITALIC="false"/>
<edge STYLE="horizontal"/>
</stylenode>
<stylenode LOCALIZED_TEXT="defaultstyle.details" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt"/>
<stylenode LOCALIZED_TEXT="defaultstyle.attributes" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt">
<font SIZE="9"/>
</stylenode>
<stylenode LOCALIZED_TEXT="defaultstyle.note" COLOR="#000000" BACKGROUND_COLOR="#ffffff" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt" TEXT_ALIGN="LEFT"/>
<stylenode LOCALIZED_TEXT="defaultstyle.floating">
<edge STYLE="hide_edge"/>
<cloud COLOR="#f0f0f0" SHAPE="ROUND_RECT"/>
</stylenode>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.user-defined" POSITION="right" STYLE="bubble">
<stylenode LOCALIZED_TEXT="styles.topic" COLOR="#18898b" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt">
<font NAME="Liberation Sans" SIZE="10" BOLD="true"/>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.subtopic" COLOR="#cc3300" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt">
<font NAME="Liberation Sans" SIZE="10" BOLD="true"/>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.subsubtopic" COLOR="#669900" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt">
<font NAME="Liberation Sans" SIZE="10" BOLD="true"/>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.important" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt">
<icon BUILTIN="yes"/>
</stylenode>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.AutomaticLayout" POSITION="right" STYLE="bubble">
<stylenode LOCALIZED_TEXT="AutomaticLayout.level.root" COLOR="#000000" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt">
<font SIZE="18"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,1" COLOR="#0033ff" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt">
<font SIZE="16"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,2" COLOR="#00b439" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt">
<font SIZE="14"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,3" COLOR="#990000" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt">
<font SIZE="12"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,4" COLOR="#111111" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt">
<font SIZE="10"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,5" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,6" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,7" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,8" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,9" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,10" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,11" STYLE="bubble" SHAPE_HORIZONTAL_MARGIN="5.0 pt" SHAPE_VERTICAL_MARGIN="3.0 pt"/>
</stylenode>
</stylenode>
</map_styles>
</hook>
<hook NAME="AutomaticEdgeColor" COUNTER="10" RULE="ON_BRANCH_CREATION"/>
<node TEXT="web服务" POSITION="right" ID="ID_540696896" CREATED="1605329673437" MODIFIED="1608379186597">
<edge COLOR="#ff0000"/>
<node TEXT="特点" ID="ID_336080991" CREATED="1608379178150" MODIFIED="1608379181248">
<node TEXT="提供页面内容的服务,基于http协议&#xa;基于B/S（Browser/Server）架构的网页服务&#xa;服务端提供网页&#xa;浏览器下载并显示网页" ID="ID_714422538" CREATED="1608379181279" MODIFIED="1608379183476"/>
</node>
<node TEXT="http默认端口80" ID="ID_1813768393" CREATED="1605329686461" MODIFIED="1608379205018">
<node TEXT="明细" ID="ID_1547936688" CREATED="1608379197542" MODIFIED="1608379200896">
<node TEXT="依赖于httpd包,由Apache软件基金会构建&#xa;默认&#xa;Listen, 监听地址:端口（80）&#xa;ServerName, 本站注册的DNS名称（空缺）&#xa;DocumentRoot, 网页根目录（/var/www/html）&#xa;DirectoryIndex, 起始/首页文件名（index.html）&#xa;基于网页文件目录进行访问控制&#xa;当子目录没有规则,默认继承上一级目录规则,针对此目录有单独配置,则不继承上一级目录规则" ID="ID_1522259647" CREATED="1608379200927" MODIFIED="1608379203504"/>
</node>
<node TEXT="/etc/httpd/conf/httpd.conf" ID="ID_959465289" CREATED="1605627896391" MODIFIED="1606469267719">
<node TEXT="主配置文件,一般不直接修改&#xa;&lt;Directory    /&gt;&#xa;    Require all denied     #拒绝所有人访问&#xa;&lt;/Directory&gt;&#xa;&#xa;&lt;Directory    &quot;/var/www&quot;&gt;&#xa;    Require all granted      #允许所有人访问&#xa;&lt;/Directory&gt;" ID="ID_28380063" CREATED="1606469261592" MODIFIED="1606469265683"/>
</node>
<node TEXT="虚拟web主机" ID="ID_1634339369" CREATED="1605628814313" MODIFIED="1608379225905">
<node TEXT="特点" ID="ID_129614471" CREATED="1608379212686" MODIFIED="1608379220560">
<node TEXT="由同一台服务器提供多个不同的web站点,一旦使用web主机功能,所有的网站都必须使用虚拟web进行呈现,并且使用调用配置文件&#xa;区分方式&#xa;基于域名的虚拟主机&#xa;基于端口的虚拟主机&#xa;基于IP地址的虚拟主机" ID="ID_1926058728" CREATED="1608379220581" MODIFIED="1608379222573"/>
</node>
<node TEXT="/etc/httpd/conf.d/*.conf" ID="ID_215300852" CREATED="1605629028326" MODIFIED="1606469336267">
<node TEXT="调用配置文件&#xa;为每个虚拟站点添加配置&#xa;&lt;VirtualHost   IP地址:端口&gt;&#xa;       ServerName  此站点的DNS名称&#xa;       DocumentRoot  此站点的网页根目录&#xa;&lt;/VirtualHost&gt;" ID="ID_236186588" CREATED="1606469324007" MODIFIED="1606469331694"/>
</node>
<node TEXT="基于域名的配置（域名不同端口相同）" ID="ID_1280587003" CREATED="1605629158951" MODIFIED="1606469377839">
<node TEXT="[root@svr7 ~]# vim  /etc/httpd/conf.d/haha.conf&#xa;&lt;VirtualHost    *:80&gt;          #在所有IP地址监听80&#xa;   ServerName   www.qq.com        #网站的域名&#xa;   DocumentRoot   /var/www/qq   #网页文件路径&#xa;&lt;/VirtualHost&gt;&#xa;&lt;VirtualHost    *:80&gt;&#xa;   ServerName    www.lol.com&#xa;   DocumentRoot   /var/www/lol&#xa;&lt;/VirtualHost&gt;" ID="ID_1325211229" CREATED="1606469370200" MODIFIED="1606469375398"/>
</node>
<node TEXT="基于端口的配置（域名相同端口不同）" ID="ID_569572427" CREATED="1605629529422" MODIFIED="1606469401092">
<node TEXT="&lt;VirtualHost   *:80&gt;&#xa;   ServerName  www.qq.com&#xa;   DocumentRoot   /var/www/qq&#xa;&lt;/VirtualHost&gt;&#xa;Listen  8080    #此处配置另一个端口指向的路径&#xa;&lt;VirtualHost   *:8080&gt;&#xa;   ServerName   www.qq.com&#xa;   DocumentRoot    /var/www/lol&#xa;&lt;/VirtualHost&gt;" ID="ID_193505308" CREATED="1606469395328" MODIFIED="1606469399160"/>
</node>
</node>
<node TEXT="路径解析实例" ID="ID_271107690" CREATED="1605627945877" MODIFIED="1606469296431">
<node TEXT="DocumentRoot 为/webroot&#xa;网络路径：curl   http://192.168.4.7/&#xa;实际服务：/webroot" ID="ID_984001815" CREATED="1606469289793" MODIFIED="1606469293710"/>
</node>
</node>
<node TEXT="nginx" ID="ID_1481890823" CREATED="1605329701850" MODIFIED="1605329704654"/>
<node TEXT="tomcat" ID="ID_1773703937" CREATED="1605329704873" MODIFIED="1605329708296"/>
</node>
<node TEXT="ftp服务默认端口21" POSITION="right" ID="ID_18294684" CREATED="1605329850323" MODIFIED="1606470133766">
<edge COLOR="#0000ff"/>
<node TEXT="安装vsftpd包&#xa;基于ftp协议默认端口21&#xa;默认共享数据的主目录在/var/ftp/" ID="ID_1396603649" CREATED="1606469427975" MODIFIED="1606469596496"/>
</node>
<node TEXT="NFS服务默认端口2049,RPC端口111" POSITION="right" ID="ID_1211555611" CREATED="1605629664914" MODIFIED="1608379248159">
<edge COLOR="#7c0000"/>
<node TEXT="特点" ID="ID_53213147" CREATED="1608379241334" MODIFIED="1608379243762">
<node TEXT="Network File System网络文件系统&#xa;为客户机提供共享使用的文件夹&#xa;协议NFS（2049）、RPC（111）&#xa;依赖于nfs-utils包&#xa;系统服务名nfs-server" ID="ID_1084505555" CREATED="1608379243786" MODIFIED="1608379245317"/>
</node>
<node TEXT="服务端配置" ID="ID_1123045469" CREATED="1605629867641" MODIFIED="1606469894203">
<node TEXT="/etc/exports&#xa;共享目标目录     IP(模式)&#xa;/public    *(ro)    #允许所有客户访问/public目录&#xa;systemctl restart nfs-server #重启服务加载配置" ID="ID_1518891934" CREATED="1606469884193" MODIFIED="1606469892524"/>
</node>
<node TEXT="客户端配置" ID="ID_69395731" CREATED="1605630080524" MODIFIED="1606470107209">
<node TEXT="创建挂载点&#xa;mkdir /mnt/mynfs&#xa;挂载&#xa;mount 192.168.4.7:/public /mnt/mynfs&#xa;开机自动挂载/etc/fstab下新增&#xa;192.168.4.7:/public /nmt/mynfs nfs defaults,_netdev 0 0&#xa;_netdev参数声明网络设备,系统在具备网络参数后,再进行挂载防止拖慢开机速度" ID="ID_1215751849" CREATED="1606470099346" MODIFIED="1606470103455"/>
</node>
</node>
<node TEXT="autofs服务" POSITION="right" ID="ID_1830997623" CREATED="1605630350510" MODIFIED="1608379262150">
<edge COLOR="#00007c"/>
<node TEXT="特点" ID="ID_40552895" CREATED="1608379255102" MODIFIED="1608379258144">
<node TEXT="触发挂载&#xa;由autofs服务提供的“按需访问”机制&#xa;只要访问挂载点就会触发响应,自动挂载指定设备&#xa;超过时限（默认5分钟）后,会自动卸载&#xa;依赖autofs包&#xa;触发挂载实现,必须多级的目录结构:/监控目录/挂载点" ID="ID_270520270" CREATED="1608379258166" MODIFIED="1608379259285"/>
</node>
<node TEXT="/etc/auto.master" ID="ID_1721724533" CREATED="1605630458456" MODIFIED="1606470492209">
<node TEXT="主配置文件&#xa;监控点目录  挂载配置文件的路径" ID="ID_382870798" CREATED="1606470487529" MODIFIED="1606470490712"/>
</node>
<node TEXT="/etc/auto.misc" ID="ID_96615996" CREATED="1605630533163" MODIFIED="1606470501945">
<node TEXT="默认挂载配置文件&#xa;触发点子目录    -挂载参数   :设备名称" ID="ID_1856180172" CREATED="1606470496585" MODIFIED="1606470499542"/>
</node>
<node TEXT="实例" ID="ID_1142034059" CREATED="1605630883391" MODIFIED="1606470511788">
<node TEXT="mkdir /myauto&#xa;vim /etc/auto.master配置&#xa;/myauto    /opt/xixi.txt&#xa;vim /opt/xixi.txt&#xa;nsd    -fstype=iso9660    :/dev/cdrom&#xa;nfs     -fstype=nfs    192.168.4.7:/public&#xa;systemctl  restart  autofs&#xa;ls /myauto/nfs" ID="ID_1793759899" CREATED="1606470506536" MODIFIED="1606470509913"/>
</node>
</node>
<node TEXT="dns服务默认端口:TCP/UDP 53" POSITION="right" ID="ID_1827904223" CREATED="1605661672271" MODIFIED="1608379371812">
<edge COLOR="#007c00"/>
<node TEXT="特点" ID="ID_126142639" CREATED="1608379362302" MODIFIED="1608379364864">
<node TEXT="dns服务器功能&#xa;正向解析:根据注册的域名查找到对应的IP地址&#xa;反向解析:根据IP地址查找对应的注册域名,不常用&#xa;域名系统: 所有的域名都必须要以点作为结尾,为树型结构&#xa;FQDN（完全合格的主机名）:站点名+注册的域名&#xa;dig  @192.168.4.7   www.bj.tedu.cn   #专业域名解析的工具" ID="ID_977756961" CREATED="1608379364926" MODIFIED="1608379366751"/>
</node>
<node TEXT="分类" ID="ID_905592278" CREATED="1605662897200" MODIFIED="1605662900749">
<node TEXT="根域名服务器" ID="ID_1260059394" CREATED="1606223609895" MODIFIED="1606470566430">
<node TEXT="域名末尾的: .&#xa;常被省略,浏览器会自动补全.&#xa;全世界只有十三台." ID="ID_1652383605" CREATED="1606470561218" MODIFIED="1606470564731"/>
</node>
<node TEXT="一级,专门负责解析一级域名" ID="ID_1170150877" CREATED="1605662901789" MODIFIED="1606470579039">
<node TEXT=".cn        .us     .tw     .hk    ………." ID="ID_1597285284" CREATED="1606470574185" MODIFIED="1606470634248"/>
</node>
<node TEXT="二级,专门解析二级域名" ID="ID_1699568025" CREATED="1605662931850" MODIFIED="1606470590955">
<node TEXT=".com.cn    .org.cn   .net.cn ………" ID="ID_647119128" CREATED="1606470586258" MODIFIED="1606470589100"/>
</node>
<node TEXT="三级,专门解析三级域名" ID="ID_1643695242" CREATED="1605662948849" MODIFIED="1606470600060">
<node TEXT="haha.com.cn    xixi.com.cn   ….." ID="ID_802592285" CREATED="1606470595274" MODIFIED="1606470624437"/>
</node>
</node>
<node TEXT="依赖包bind,bind-chroot（提供牢笼政策）" ID="ID_1412816178" CREATED="1605665056321" MODIFIED="1608379277123">
<node TEXT="特点" ID="ID_1145887154" CREATED="1608379270454" MODIFIED="1608379273528">
<node TEXT="伯克利internet域名服务&#xa;官方站点www.isc.org&#xa;主执行程序/usr/sbin/named&#xa;系统服务named&#xa;运行时虚拟根环境/var/named/chroot/" ID="ID_1231560713" CREATED="1608379273553" MODIFIED="1608379275354"/>
</node>
<node TEXT="/etc/named.conf" ID="ID_588700637" CREATED="1605666389336" MODIFIED="1606470655050">
<node TEXT="主配置文件&#xa;设置负责解析的域名&#xa;可先备份以防出错后修改&#xa;保留directory和zone字段内容即可&#xa;options {&#xa;        directory     &quot;/var/named&quot;;     #定义地址库文件存放路径&#xa;};&#xa;zone &quot;tedu.cn&quot;  IN {           #定义负责的解析tedu.cn域名&#xa;        type master;               #权威主DNS服务器&#xa;        file  &quot;tedu.cn.zone&quot;;     #地址库文件名称&#xa;};" ID="ID_1696471002" CREATED="1606470648785" MODIFIED="1606470652457"/>
</node>
<node TEXT="/var/named" ID="ID_671163244" CREATED="1605666415607" MODIFIED="1606470681455">
<node TEXT="地址库文件&#xa;完全合格的主机名与IP地址的对应关系&#xa;保证named用户对地址库文件有读取权限,可使用cp -p命令&#xa;所有的域名都要以点作为结尾&#xa;如果没有以点作为结尾，那么默认补全本地库文件负责的域名&#xa;DNS服务器资源解析记录的类型：&#xa;      NS:DNS服务器声明记录&#xa;      A：正向解析记录&#xa;      CNAME：解析记录的别名" ID="ID_1587112105" CREATED="1606470675092" MODIFIED="1606470764056"/>
</node>
</node>
<node TEXT="多区域的DNS服务器" ID="ID_112988345" CREATED="1606224691553" MODIFIED="1606470852618">
<node TEXT="vim   /etc/named.conf&#xa;options {&#xa;        directory       &quot;/var/named&quot;;&#xa;};&#xa;zone &quot;tedu.cn&quot;  IN  {&#xa;        type   master;&#xa;        file  &quot;tedu.cn.zone&quot;;&#xa;};&#xa;zone  &quot;lol.com&quot;  IN  {   #增加其他域名&#xa;         type  master;&#xa;         file  &quot;lol.com.zone&quot;;&#xa;};" ID="ID_1450790865" CREATED="1606470845250" MODIFIED="1606470849001"/>
</node>
<node TEXT="特殊解析" ID="ID_434766382" CREATED="1606269519104" MODIFIED="1606269527878">
<node TEXT="轮询（负载均衡）" ID="ID_1373975869" CREATED="1606269529181" MODIFIED="1606471517166">
<node TEXT="tedu.cn.   NS   svr7&#xa;svr7          A    192.168.4.7&#xa;www         A    192.168.4.20&#xa;www        A     192.168.4.21&#xa;www        A     192.168.4.22  #随机匹配一个给客户&#xa;ftp           A     2.2.2.2" ID="ID_1795778457" CREATED="1606471508985" MODIFIED="1606471514068"/>
</node>
<node TEXT="泛域名解析" ID="ID_108880404" CREATED="1606269583941" MODIFIED="1606471528165">
<node TEXT="tedu.cn.  NS   svr7&#xa;svr7         A    192.168.4.7&#xa;www       A    192.168.4.20&#xa;ftp           A    2.2.2.2&#xa;*              A    6.6.6.6    #忽略前缀,比如wwwa.tedu.cn,也能连到www.tedu.cn&#xa;tedu.cn.   A    7.7.7.7  #自动补全www." ID="ID_847596716" CREATED="1606471523250" MODIFIED="1606471526688"/>
</node>
<node TEXT="解析记录别名" ID="ID_576941097" CREATED="1606270011180" MODIFIED="1606471539337">
<node TEXT="vim   /var/named/tedu.cn.zone&#xa;……此处省略一万字&#xa;tedu.cn.   NS   svr7&#xa;svr7          A     192.168.4.7&#xa;www         A     192.168.4.20&#xa;ftp           A      2.2.2.2&#xa;*               A      6.6.6.6&#xa;tedu.cn.   A      7.7.7.7&#xa;vip       CNAME    ftp         #vip解析结果与ftp解析结果一致" ID="ID_1741498587" CREATED="1606471533131" MODIFIED="1606471537234"/>
</node>
</node>
<node TEXT="递归查询（递归解析）" ID="ID_1505329660" CREATED="1606270118438" MODIFIED="1608379327603">
<node TEXT="特点" ID="ID_853568570" CREATED="1608379319766" MODIFIED="1608379322768">
<node TEXT="客户端发送请求给首选DNS服务器，首选DNS服务器与其他的DNS服务器交互，最终将解析结果带回来过程" ID="ID_934159556" CREATED="1608379322803" MODIFIED="1608379324437"/>
</node>
<node TEXT="服务器A子域授权" ID="ID_209228656" CREATED="1606272074811" MODIFIED="1608379295164">
<node TEXT="vim /var/named/tedu.cn.zone&#xa;tedu.cn.      NS    svr7&#xa;bj.tedu.cn.  NS    pc207&#xa;svr7            A      192.168.4.7&#xa;pc207         A      192.168.4.207&#xa;www           A      192.168.4.20&#xa;ftp               A      2.2.2.2&#xa;*                  A       4.4.4.4&#xa;tedu.cn.       A       5.5.5.5&#xa;vip              CNAME  ftp" ID="ID_225698359" CREATED="1608379289417" MODIFIED="1608379292191"/>
</node>
<node TEXT="服务器B负责子域解析" ID="ID_1132372742" CREATED="1606272159026" MODIFIED="1608379307387">
<node TEXT="options {&#xa;        directory       &quot;/var/named&quot;;&#xa;};&#xa;zone &quot;bj.tedu.cn&quot; IN {&#xa;        type master;&#xa;        file &quot;bj.tedu.cn.zone&quot;;&#xa;};&#xa;vim bj.tedu.cn.zone&#xa;……此处省略一万字&#xa;bj.tedu.cn.     NS   pc207&#xa;pc207           A    192.168.4.207&#xa;www             A     9.9.9.9" ID="ID_1225995196" CREATED="1608379299689" MODIFIED="1608379305549"/>
</node>
</node>
<node TEXT="迭代查询（迭代解析）" ID="ID_24634509" CREATED="1606270174918" MODIFIED="1608379352270">
<node TEXT="特点" ID="ID_15715187" CREATED="1608379336238" MODIFIED="1608379338600">
<node TEXT="客户端发送请求给首选DNS服务器，首选DNS服务器告知下一个DNS服务器地址" ID="ID_1063271474" CREATED="1608379338622" MODIFIED="1608379339885"/>
</node>
<node TEXT="禁止递归查询" ID="ID_24814394" CREATED="1606272495253" MODIFIED="1608379348080">
<node TEXT="vim /etc/named.conf&#xa;options {&#xa;        directory       &quot;/var/named&quot;;&#xa;        recursion no;    #禁止递归查询&#xa;};" ID="ID_1426343836" CREATED="1608379343916" MODIFIED="1608379346275"/>
</node>
</node>
<node TEXT="主从DNS服务器架构" ID="ID_614372858" CREATED="1606224704290" MODIFIED="1608379396586">
<node TEXT="特点" ID="ID_1289276140" CREATED="1608379388799" MODIFIED="1608379391888">
<node TEXT="作用：提高可靠性，从DNS服务器备份主DNS服务器的数据" ID="ID_854590615" CREATED="1608379391912" MODIFIED="1608379393038"/>
</node>
<node TEXT="服务器A授权从属服务器" ID="ID_1683007165" CREATED="1606273881878" MODIFIED="1608379381186">
<node TEXT="vim   /etc/named.conf&#xa;options {&#xa;     directory       &quot;/var/named&quot;;&#xa;     allow-transfer  {  192.168.4.207;   };    #允许谁进行传输数据&#xa;};&#xa;zone &quot;tedu.cn&quot; IN {&#xa;        type master;&#xa;        file &quot;tedu.cn.zone&quot;;&#xa;};&#xa;zone &quot;lol.com&quot; IN {&#xa;        type master;&#xa;        file &quot;lol.com.zone&quot;;&#xa;};&#xa;    2. 声明从DNS服务器&#xa;[root@svr7 /]# vim     /var/named/lol.com.zone&#xa;……此处省略一万字&#xa;lol.com.   NS   svr7&#xa;lol.com.   NS   pc207            #声明从DNS服务器&#xa;svr7         A     192.168.4.7&#xa;pc207      A     192.168.4.207&#xa;www        A     4.4.4.4" ID="ID_62024791" CREATED="1608379376734" MODIFIED="1608379379288"/>
</node>
<node TEXT="服务器B配置为从服务器" ID="ID_1468538092" CREATED="1606274070138" MODIFIED="1608379406665">
<node TEXT="vim   /etc/named.conf&#xa;options  {&#xa;        directory       &quot;/var/named&quot;;&#xa;};&#xa;zone  &quot;lol.com&quot;  IN  {&#xa;  type   slave;               #类型为从服务器&#xa;  file &quot;/var/named/slaves/lol.com.slave&quot;;  #确保named用户有读写执行权限&#xa;  masters     {   192.168.4.7;    };   #指定主DNS服务器&#xa;  masterfile-format    text;        #地址库文件明文存储&#xa;};" ID="ID_724376769" CREATED="1608379400089" MODIFIED="1608379403295"/>
</node>
<node TEXT="主从数据同步设置" ID="ID_1058352903" CREATED="1606274225638" MODIFIED="1608379417088">
<node TEXT="主服务器配置&#xa;vim    /var/named/lol.com.zone&#xa;…….此处省略一万字&#xa;     2020111801     ; serial  #数据的版本号，由10个数字组成&#xa;           1D      ; refresh    #每隔1天主从进行数据交互&#xa;           1H      ; retry        #失效之后的时间间隔每一个1小时&#xa;           1W      ; expire     #真正的失效时间，1周&#xa;           3H )    ; minimum  #失效记录的记忆时间3小时&#xa;lol.com.    NS   svr7&#xa;lol.com.    NS   pc207&#xa;svr7          A     192.168.4.7&#xa;pc207       A     192.168.4.207&#xa;www         A     11.12.13.14" ID="ID_1036560676" CREATED="1608379410180" MODIFIED="1608379415524"/>
</node>
</node>
<node TEXT="缓存DNS服务器" ID="ID_1313110550" CREATED="1606224718113" MODIFIED="1608379424217"><richcontent TYPE="DETAILS">

<html>
  <head>
    
  </head>
  <body>
    <p>
      作用：缓存解析结果，加快访问
    </p>
  </body>
</html>

</richcontent>
<node TEXT="特点" ID="ID_969081259" CREATED="1608379425254" MODIFIED="1608379429072">
<node TEXT="作用：缓存解析结果，加快访问" ID="ID_1471094252" CREATED="1608379429091" MODIFIED="1608379430770"/>
</node>
<node TEXT="配置" ID="ID_1040897963" CREATED="1606275534238" MODIFIED="1608379438632">
<node TEXT="vim   /etc/named.conf&#xa;options  {&#xa;       directory      &quot;/var/named&quot;;&#xa;       forwarders   {   192.168.4.7;   };      #转发给192.168.4.7&#xa;};" ID="ID_1786630514" CREATED="1608379434762" MODIFIED="1608379437167"/>
</node>
</node>
<node TEXT="分离解析" ID="ID_1141177878" CREATED="1606275602794" MODIFIED="1608379513587">
<node TEXT="特点" ID="ID_1918933551" CREATED="1608379447718" MODIFIED="1608379450800">
<node TEXT="当收到客户机的DNS查询请求的时候&#xa;能够区分客户机的来源地址&#xa;为不同类别的客户机提供不同的解析结果（IP地址）&#xa;为客户端提供最近的服务器&#xa;    • 分离解析配置&#xa;        ◦ 客户端必须找到自己的类型&#xa;        ◦ 由上到下依次匹配，匹配及停止&#xa;        ◦ 所有的zone都必须在view当中&#xa;        ​ 每一个view中，zone个数要一致&#xa;        ​ 每一个view中，zone负责的域名要一致" ID="ID_435041105" CREATED="1608379450825" MODIFIED="1608379451718"/>
</node>
<node TEXT="view  &quot;haha&quot; {&#xa;    match-clients   {   192.168.4.0/24;   192.168.8.1;     };&#xa;    zone  &quot;12306.cn&quot;  IN  {&#xa;        …… 地址库1;&#xa;    };    };&#xa;view  &quot;xixi&quot; {&#xa;    match-clients   {     any;      };&#xa;    zone  &quot;12306.cn&quot;  IN {&#xa;        …… 地址库2;&#xa;    };    };" ID="ID_290594053" CREATED="1606278131423" MODIFIED="1608379667749"/>
<node TEXT="配置" ID="ID_136977522" CREATED="1608379652726" MODIFIED="1608379658824">
<node TEXT="1.修改主配置文件&#xa;[root@svr7 /]# vim /etc/named.conf&#xa;options {&#xa;        directory        &quot;/var/named&quot;;&#xa;};&#xa;view      &quot;nsd&quot;     {&#xa; match-clients     {     192.168.4.207;       192.168.7.0/24;     };&#xa; zone   &quot;lol.com&quot;    IN {&#xa;        type   master;&#xa;        file    &quot;lol.com.zone&quot;;&#xa; };&#xa;};&#xa;view      &quot;other&quot;     {&#xa; match-clients      {      any;     };&#xa; zone    &quot;lol.com&quot;    IN {&#xa;        type    master;&#xa;        file     &quot;lol.com.other&quot;;&#xa; };&#xa;};&#xa;2．建立地址库文件&#xa;]# cd    /var/named/&#xa;]# vim        lol.com.zone&#xa;此处省略一万字……..&#xa;lol.com.    NS  svr7&#xa;svr7           A   192.168.4.7&#xa;www         A   192.168.4.100&#xa;]# cp  -p    lol.com.zone      lol.com.other&#xa;]# vim        lol.com.other&#xa;此处省略一万字……..&#xa;lol.com.     NS   svr7&#xa;svr7           A     192.168.4.7&#xa;www          A     1.2.3.4" ID="ID_636229941" CREATED="1608379658865" MODIFIED="1608379663563"/>
</node>
<node TEXT="例子" ID="ID_474094381" CREATED="1606278301006" MODIFIED="1608379636988">
<node TEXT="        ​ 权威DNS：svr7.tedu.cn  192.168.4.7&#xa;        ​ 负责区域：lol.com   qq.com&#xa;        ​ A记录分离解析 —— 以 www.lol.com   www.qq.com为例&#xa;        ​ 要求：&#xa;    • 192.168.4.207 -- www.lol.com ---&gt;192.168.4.100&#xa;    • any--- www.lol.com --&gt;1.2.3.4&#xa;&#xa;    • 192.168.4.207--www.qq.com---&gt;192.168.4.200&#xa;    • any-- www.qq.com ---&gt;10.20.30.40&#xa;虚拟机A：&#xa;[root@svr7 named]# vim /etc/named.conf&#xa;options {&#xa;        directory       &quot;/var/named&quot;;&#xa;};&#xa;view &quot;nsd&quot; {&#xa; match-clients  {  192.168.4.207;  192.168.7.0/24;   };&#xa; zone &quot;lol.com&quot; IN {&#xa;        type master;&#xa;        file &quot;lol.com.zone&quot;;&#xa; };&#xa; zone &quot;qq.com&quot; IN {&#xa;        type master;&#xa;        file &quot;qq.com.zone&quot;;&#xa; };&#xa;};&#xa;&#xa;view &quot;other&quot; {&#xa; match-clients {  any;   };&#xa; zone &quot;lol.com&quot; IN {&#xa;        type master;&#xa;        file &quot;lol.com.other&quot;;&#xa; };&#xa; zone &quot;qq.com&quot; IN {&#xa;        type master;&#xa;        file &quot;qq.com.other&quot;;&#xa; };&#xa;};&#xa;2.建立地址库文件&#xa;]# cd   /var/named/&#xa;]# cp -p  named.localhost    qq.com.zone&#xa;]# vim   qq.com.zone&#xa;此处省略一万字……..&#xa;qq.com.  NS      svr7&#xa;svr7        A       192.168.4.7&#xa;www       A       192.168.4.200&#xa;]# cp  -p   qq.com.zone    qq.com.other&#xa;]# vim qq.com.other&#xa;此处省略一万字……..&#xa;qq.com.  NS      svr7&#xa;svr7         A       192.168.4.7&#xa;www       A       10.20.30.40&#xa;[root@svr7 named]# systemctl   restart   named&#xa;    •  针对来源地址定义acl列表(了解内容)&#xa;        ​ 若地址比较少，也可以不建立列表&#xa;&#xa;options {&#xa;        directory       &quot;/var/named&quot;;&#xa;};&#xa;acl  &quot;test&quot;   {   192.168.4.207;    192.168.7.0/24;   };&#xa;view &quot;nsd&quot; {&#xa; match-clients   {   test;   };&#xa; zone &quot;lol.com&quot; IN  {&#xa;此处省略一万字…….." ID="ID_1493842994" CREATED="1608379629039" MODIFIED="1608379633287"/>
</node>
</node>
</node>
<node TEXT="NTP时间服务器" POSITION="right" ID="ID_216807656" CREATED="1606278481932" MODIFIED="1608379710102">
<edge COLOR="#7c007c"/>
<node TEXT="特点" ID="ID_315983693" CREATED="1608379700982" MODIFIED="1608379704504">
<node TEXT="作用：提供标准时间&#xa;    • Network Time Protocol（网络时间协议）&#xa;    • 它用来同步网络中各个计算机的时间的协议&#xa;    • 210.72.145.39 (国家授时中心服务器IP地址)&#xa;    • Stratum（分层设计）&#xa;    • Stratum层的总数限制在15以内（包括15）" ID="ID_1119337266" CREATED="1608379704526" MODIFIED="1608379707326"/>
</node>
<node TEXT="依赖包chrony" ID="ID_1015163416" CREATED="1606278871266" MODIFIED="1606278885216"/>
<node TEXT="/etc/chrony.conf" ID="ID_316652710" CREATED="1606278893805" MODIFIED="1608379722927">
<node TEXT="服务端配置&#xa;#server   0.centos.pool.ntp.org   iburst    #与谁同步时间&#xa;#server   1.centos.pool.ntp.org   iburst    #iburst表示快速同步&#xa;#server   2.centos.pool.ntp.org   iburst&#xa;#server   3.centos.pool.ntp.org   iburst&#xa;26行  allow   all           #开头的#去掉，修改为允许所有客户端&#xa;29行  local  stratum  10     #设置本机为第10层的时间服务器" ID="ID_70534382" CREATED="1608379717617" MODIFIED="1608379720494"/>
</node>
<node TEXT="客户端配置" ID="ID_652032647" CREATED="1606278991435" MODIFIED="1608379732004">
<node TEXT="vim   /etc/chrony.conf&#xa;server  192.168.4.7   iburst      #与192.168.4.7同步时间&#xa;#server  1.centos.pool.ntp.org  iburst    #iburst表示快速同步&#xa;#server  2.centos.pool.ntp.org  iburst&#xa;#server  3.centos.pool.ntp.org  iburst" ID="ID_1156222522" CREATED="1608379726567" MODIFIED="1608379730287"/>
</node>
<node TEXT="chronyc sources -v 列出时间服务器信息" ID="ID_1171554140" CREATED="1606279057535" MODIFIED="1606279113624"/>
</node>
<node TEXT="邮件服务器" POSITION="right" ID="ID_833625942" CREATED="1606279121712" MODIFIED="1608379767050">
<edge COLOR="#007c7c"/>
<node TEXT="特点" ID="ID_1485033574" CREATED="1608379739950" MODIFIED="1608379742768">
<node TEXT="    • 电子邮件服务器的基本功能&#xa;        ​ 为用户提供电子邮箱存储空间（用户名@邮件域名）&#xa;        ​ 处理用户发出的邮件 —— 传递给收件服务器&#xa;        ​ 处理用户收到的邮件 —— 投递到邮箱" ID="ID_1612019292" CREATED="1608379742786" MODIFIED="1608379744461"/>
</node>
<node TEXT="DNS添加邮件解析功能" ID="ID_1856410362" CREATED="1606279175953" MODIFIED="1608379754205">
<node TEXT="1.修改主配置文件&#xa;[root@svr7 /]# vim /etc/named.conf&#xa;options {&#xa;        directory       &quot;/var/named&quot;;&#xa;};&#xa;zone  &quot;qq.com&quot;   IN   {&#xa;         type   master;&#xa;         file   &quot;qq.com.zone&quot;;&#xa;};&#xa;2.建立地址库文件&#xa;[root@svr7 /]# cd    /var/named/&#xa;[root@svr7 named]# vim   qq.com.zone&#xa;此处省略一万字……..&#xa;qq.com.   NS           svr7&#xa;qq.com.   MX   10   mail          #数字10为优先级，越小越优先&#xa;svr7         A             192.168.4.7&#xa;mail         A             192.168.4.7&#xa;www        A             192.168.4.200&#xa;]# systemctl   restart   named&#xa;&#xa;]# echo  nameserver 192.168.4.7   &gt;   /etc/resolv.conf&#xa;]# host  -t  MX  qq.com         #测试qq.com区域邮件交换记录&#xa;qq.com mail is handled by 10 mail.qq.com.&#xa;&#xa;]# host mail.qq.com              #测试域名完整解析&#xa;mail.qq.com has address 192.168.4.7" ID="ID_476287333" CREATED="1608379748937" MODIFIED="1608379751975"/>
</node>
<node TEXT="安装postfix" ID="ID_1187075232" CREATED="1606279313101" MODIFIED="1606279329585"/>
<node TEXT="配置" ID="ID_757933928" CREATED="1606279336307" MODIFIED="1608379762884">
<node TEXT="vim  /etc/postfix/main.cf&#xa;99  myorigin = qq.com     #默认补全的域名后缀&#xa;116 inet_interfaces =  all #本机所有IP地址均提供邮件收发功能&#xa;164 mydestination = qq.com    #判断是否为本域邮件的依据&#xa;3.重启邮件服务" ID="ID_664110480" CREATED="1608379758613" MODIFIED="1608379761367"/>
</node>
<node TEXT="测试" ID="ID_146137838" CREATED="1606279374882" MODIFIED="1608379778320">
<node TEXT="4.测试&#xa;    • mail 发信操作: mail   -s   &apos;邮件标题&apos;     -r    发件人   收件人&#xa;[root@svr7 /]# useradd   yg&#xa;[root@svr7 /]# useradd    xln&#xa;[root@svr7 /]# mail   -s    &apos;test01&apos;    -r   yg    xln&#xa;ahahaxixiehehelele&#xa;.                #一行只有一个点表示提交&#xa;EOT&#xa;&#xa;    • mail 收信操作: mail    [-u  用户名]&#xa;[root@svr7 /]# mail   -u    xln&#xa;&gt;N  1  yg@qq.com             Fri Sep 18 17:24  18/510&#xa;&amp;  1            #输入邮件编号&#xa;&amp;  quit       #退出&#xa;[root@svr7 /]# echo 123456   |   mail   -s   &apos;test02&apos;  -r  yg  xln&#xa;[root@svr7 /]# mail  -u  xln" ID="ID_92887211" CREATED="1608379773722" MODIFIED="1608379776553"/>
</node>
</node>
<node TEXT="systemd" POSITION="right" ID="ID_1374566875" CREATED="1605625542120" MODIFIED="1608379808068">
<edge COLOR="#00ff00"/>
<node TEXT="特点" ID="ID_607771651" CREATED="1608379799502" MODIFIED="1608379802344">
<node TEXT="服务和服务管理器（上帝进程）&#xa;内核引导之后加载的第一个初始化进程（PID=1）&#xa;负责掌控整个linux的运行/服务资源组合&#xa;开机服务并行启动,各系统服务间的精确依赖&#xa;管理时与手动启动的服务有冲突,最好先把手动启用的服务杀掉" ID="ID_194766853" CREATED="1608379802370" MODIFIED="1608379805879"/>
</node>
<node TEXT="配置目录" ID="ID_1315846944" CREATED="1608379817871" MODIFIED="1608379820689">
<node TEXT="/etc/systemd/system" ID="ID_767427342" CREATED="1605625695154" MODIFIED="1608379823644"/>
</node>
<node TEXT="服务目录" ID="ID_1544404896" CREATED="1608379828358" MODIFIED="1608379830726">
<node TEXT="/lib/systemd/system" ID="ID_1013072688" CREATED="1605625709576" MODIFIED="1608379832303"/>
</node>
<node TEXT="systemctl" ID="ID_1511752269" CREATED="1605625720536" MODIFIED="1605625762484"><richcontent TYPE="DETAILS">

<html>
  <head>
    
  </head>
  <body>
    <p>
      管理工具
    </p>
  </body>
</html>
</richcontent>
<node TEXT="列出所有的服务" ID="ID_759151617" CREATED="1608379839159" MODIFIED="1608379841270">
<node TEXT="systemctl -t service --all" ID="ID_58862189" CREATED="1605625769698" MODIFIED="1608379844103"/>
</node>
<node TEXT="启动|停止|重启指定服务" ID="ID_235140358" CREATED="1608379849430" MODIFIED="1608379852085">
<node TEXT="systemctl start|stop|restart| 服务名称" ID="ID_778734812" CREATED="1605625803824" MODIFIED="1608379875252"/>
</node>
<node TEXT="查看服务当前状态" ID="ID_1846751259" CREATED="1608379855303" MODIFIED="1608379858026">
<node TEXT="systemctl status 服务名" ID="ID_481444063" CREATED="1605625883655" MODIFIED="1608379877826"/>
</node>
<node TEXT="设置|取消服务开机自启动" ID="ID_1050960452" CREATED="1608379861399" MODIFIED="1608379863492">
<node TEXT="systemctl enable|disable 服务名" ID="ID_1961185854" CREATED="1605625918912" MODIFIED="1608379880538"/>
</node>
<node TEXT="查看指定服务是否开机启动" ID="ID_151221088" CREATED="1608379868639" MODIFIED="1608379870882">
<node TEXT="systemctl is-enabled 服务名" ID="ID_1580588179" CREATED="1605625963240" MODIFIED="1608379883449"/>
</node>
</node>
<node TEXT="系统运行级别" ID="ID_247097657" CREATED="1606218928793" MODIFIED="1606218936295">
<node TEXT="systemctl isolate multi-user.target  //当前直接切换到多用户字符模式&#xa;相当于rhel6的init 3" ID="ID_906129711" CREATED="1606218947151" MODIFIED="1608379919390"/>
<node TEXT="systemctl isolate graphical.target  //当前切换到图形模式&#xa;相当于rhel6的init 5" ID="ID_917100053" CREATED="1606218988028" MODIFIED="1608379922344"/>
<node TEXT="systemctl get-default  //查看每次开机默认进入模式" ID="ID_1558659399" CREATED="1606219114423" MODIFIED="1608379924829"/>
<node TEXT="systemctl set-default multi-user.target  //设置永久策略,开机自动进入multi-user.target" ID="ID_179812192" CREATED="1606219148159" MODIFIED="1608379927390"/>
</node>
</node>
<node TEXT="端口" POSITION="right" ID="ID_1189944384" CREATED="1605628573664" MODIFIED="1608379941706">
<edge COLOR="#ff00ff"/>
<node TEXT="特点" ID="ID_760042781" CREATED="1608379935773" MODIFIED="1608379938136">
<node TEXT="数字编号起到标识作用,标识协议&#xa;建议自定义端口时大于1024,端口的极限为65535&#xa;1024以内的端口常为服务默认端口使用,使用1024以上端口是为了避免端口冲突" ID="ID_1719518888" CREATED="1608379938168" MODIFIED="1608379939676"/>
</node>
<node TEXT="各协议默认端口" ID="ID_1737741693" CREATED="1606221211998" MODIFIED="1608379950020">
<node TEXT="http, 80&#xa;DNS, 53&#xa;ssh, 22" ID="ID_1375442998" CREATED="1608379946255" MODIFIED="1608379948364"/>
</node>
</node>
<node TEXT="hosts" POSITION="right" ID="ID_401530168" CREATED="1605629357104" MODIFIED="1608379957884">
<edge COLOR="#00ffff"/>
<node TEXT="/etc/hosts文件直接解析域名,只为本机解析&#xa;格式&#xa;IP地址    域名  域名  ..." ID="ID_1664110741" CREATED="1608379953294" MODIFIED="1608379956190"/>
</node>
</node>
</map>
